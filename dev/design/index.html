<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Design · OpenTelemetry.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-YWC6SQHSVM"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-YWC6SQHSVM', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="OpenTelemetry.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">OpenTelemetry.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Design</span><ul><li><a class="tocitem" href="../design_api/">API</a></li><li><a class="tocitem" href="../design_sdk/">SDK</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Design</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Design</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/master/docs/src/design.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Design"><a class="docs-heading-anchor" href="#Design">Design</a><a id="Design-1"></a><a class="docs-heading-anchor-permalink" href="#Design" title="Permalink"></a></h1><p>The content in this page is organized in the same order as the <a href="https://github.com/open-telemetry/opentelemetry-specification">OpenTelemetry Specification</a>.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><h3 id="Context"><a class="docs-heading-anchor" href="#Context">Context</a><a id="Context-1"></a><a class="docs-heading-anchor-permalink" href="#Context" title="Permalink"></a></h3><p><code>Context</code> is implemented as a wrapper of <code>NamedTuple</code>, which means it is immutable. Each <code>Task</code> has exactly <strong>ONE</strong> <code>Context</code> instance, which is injected into the <code>task_local_storage</code> of the <code>current_task</code> by the parent task automatically.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p><a href="https://docs.julialang.org/en/v1/manual/style-guide/#Avoid-type-piracy">Type piracy</a> is used to the propagate context between tasks.</p></div></div><p><code>create_key</code> is used to create a context key. But it is not exported yet because it seems to be only used internally until now.</p><p><code>Base.getindex(::Context, key)</code> is implemented so to get a value in a <code>Context</code>, one can simply call <code>ctx[key]</code> to get the associated value of a key in a <code>ctx</code>.</p><p>Setting value of a <code>Context</code> is not directly supported. Given that <code>Context</code> is immutable, updating an immutable object in Julia seems strange. We provide the <a href="#OpenTelemetryAPI.with_context"><code>with_context</code></a> function to create a new context based on the key-value pairs in the <a href="#OpenTelemetryAPI.current_context"><code>current_context</code></a>. This syntax is more common than the attach/detach operations in the original specification.</p><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.with_context" href="#OpenTelemetryAPI.with_context"><code>OpenTelemetryAPI.with_context</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">with_context(f, [context]; kv...)</code></pre><p>Run function <code>f</code> in the <code>context</code>. If extra <code>kv</code> pairs are provided, they will be merged with the <code>context</code> to form a new context. When <code>context</code> is not provided, the <a href="#OpenTelemetryAPI.current_context"><code>current_context</code></a> will be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/common.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.current_context" href="#OpenTelemetryAPI.current_context"><code>OpenTelemetryAPI.current_context</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Return the <code>Context</code> associated with the caller&#39;s current execution unit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/common.jl#L43-L45">source</a></section></article><h3 id="Propagators"><a class="docs-heading-anchor" href="#Propagators">Propagators</a><a id="Propagators-1"></a><a class="docs-heading-anchor-permalink" href="#Propagators" title="Permalink"></a></h3><p><a href="#OpenTelemetryAPI.inject!"><code>inject!</code></a> and <a href="#OpenTelemetryAPI.extract"><code>extract</code></a> are provided to </p><p>The global propagator can be set to a <code>CompositePropagator</code>, with multiple dispatch, each inner propagator can be customized to handle different contexts and carriers.</p><p><code>TextMapPropagator</code> is not implemented yet! Personally I feel that every propagator may depends on a third party package. To minimize the dependencies of <code>OpenTelemetryAPI.jl</code>, those specialized propagators can be registered as independent packages.</p><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.inject!" href="#OpenTelemetryAPI.inject!"><code>OpenTelemetryAPI.inject!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">inject(carrier, [global_propagator], [current_context])</code></pre><p>Injects the value into a carrier. For example, into the headers of an HTTP request.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/propagator.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.extract" href="#OpenTelemetryAPI.extract"><code>OpenTelemetryAPI.extract</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">extract(carrier, [global_propagator], [current_context])</code></pre><p>Extracts the value from an incoming request. For example, from the headers of an HTTP request.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/propagator.jl#L30-L34">source</a></section></article><h3 id="Trace"><a class="docs-heading-anchor" href="#Trace">Trace</a><a id="Trace-1"></a><a class="docs-heading-anchor-permalink" href="#Trace" title="Permalink"></a></h3><p>The relationship between trace provider, tracer, span context and span is depicted below:</p><pre><code class="nohighlight hljs">┌────────────────────────────┐
│Span                        │
│                            │
│ tracer                     │
│   ┌──────────────────────┐ │
│   │Tracer                │ │
│   │                      │ │
│   │  provider            │ │
│   │   ┌────────────────┐ │ │
│   │   │    Abstract    │ │ │
│   │   │ TracerProvider │ │ │
│   │   └────────────────┘ │ │
│   │  instrumentation     │ │
│   │   ┌────────────────┐ │ │
│   │   │ name           │ │ │
│   │   │ version        │ │ │
│   │   └────────────────┘ │ │
│   │                      │ │
│   └──────────────────────┘ │
│ span_context               │
│   ┌──────────────────────┐ │
│   │ trace_id             │ │
│   │ span_id              │ │
│   │ is_remote            │ │
│   │ trace_flag           │ │
│   │ trace_state          │ │
│   └──────────────────────┘ │
│ parent_span_context        │
│ kind                       │
│ start_time                 │
│ end_time                   │
│ attributes                 │
│ links                      │
│ events                     │
│ status                     │
└────────────────────────────┘</code></pre><ul><li>In <code>OpenTelemetryAPI.jl</code>, only one <code>AbstractTracerProvider</code> (<code>DummyTracerProvider</code>) is provided and is set as the <a href="#OpenTelemetryAPI.global_tracer_provider"><code>global_tracer_provider</code></a>.</li><li><code>Span</code> is immutable. Modifiable fields like <code>status</code>, <code>end_time</code> are set to <code>Ref</code>.</li><li>To add <a href="#OpenTelemetryAPI.Event"><code>Event</code></a>s and <a href="#OpenTelemetryAPI.Link"><code>Link</code></a>s, users can call <code>push!(span, event_or_link)</code>.</li><li>The <code>attributes</code> in the <a href="#OpenTelemetryAPI.Span"><code>Span</code></a> is a <a href="@ref"><code>DynamicAttrs</code></a>, and can be updated with the syntax like <code>span[key]=value</code>.</li><li><code>end_time</code> will be set by default after the call to <a href="#OpenTelemetryAPI.with_span"><code>with_span</code></a>.</li><li>Always use <code>set_status!</code> to update the status of span.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In some other languages, only a dummy span is defined in API and the concrete span is defined in SDK. Personally I prefer to defined it in API, otherwise we need to define many <em>getter</em> methods.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.global_tracer_provider" href="#OpenTelemetryAPI.global_tracer_provider"><code>OpenTelemetryAPI.global_tracer_provider</code></a> — <span class="docstring-category">Function</span></header><section><div><p>get the global tracer provider</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L12-L14">source</a></section><section><div><p>set the global tracer provider to <code>p</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L17-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.Tracer" href="#OpenTelemetryAPI.Tracer"><code>OpenTelemetryAPI.Tracer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Tracer(;provider=global_tracer_provider(), instrumentation=InstrumentationInfo())</code></pre><p>For instrumentation library developers, <code>instrumentation</code> must be configured clearly instead of the default value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.Span" href="#OpenTelemetryAPI.Span"><code>OpenTelemetryAPI.Span</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Span(name::String, tracer::Tracer{TracerProvider};kw...)</code></pre><p><strong>Keyword Arguments</strong></p><ul><li><code>context=current_context()</code>,</li><li><code>kind=SPAN_KIND_INTERNAL</code>,</li><li><code>attributes=Dict{String, TAttrVal}()</code>,</li><li><code>links=Link[]</code>,</li><li><code>events=Event[]</code>,</li><li><code>start_time::UInt=time()*10^9</code>, the nanoseconds.</li><li><code>is_remote=false</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/sdk/src/trace/trace_provider.jl#L36-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.current_span" href="#OpenTelemetryAPI.current_span"><code>OpenTelemetryAPI.current_span</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">current_span([current_context])</code></pre><p>Get the span in the current context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/basic.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.with_span" href="#OpenTelemetryAPI.with_span"><code>OpenTelemetryAPI.with_span</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">with_span(f, s::AbstractSpan;kw...)</code></pre><p>Call function <code>f</code> with the current span set to <code>s</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>end_on_exit=true</code>, controls whether to call <a href="#OpenTelemetryAPI.end!"><code>end!</code></a> after <code>f</code> or not.</li><li><code>record_exception=true</code>, controls whether to record the exception.</li><li><code>set_status_on_exception=true</code>, decides whether to set status to <a href="@ref"><code>SPAN_STATUS_ERROR</code></a> automatically when an exception is caught.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L73-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.push!-Tuple{Span, Exception}" href="#Base.push!-Tuple{Span, Exception}"><code>Base.push!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>A specialized variant of <code>add_event!</code> to record exceptions. Usually used in a <code>try... catch...end</code> to capture the backtrace. If the <code>ex</code> is <code>rethrow</code>ed in the <code>catch...end</code>, <code>is_rethrow_followed</code> should be set to <code>true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L185-L187">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Base.push!(s::Span, link::Link)</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Base.setindex!-Tuple{Span, Any, Any}" href="#Base.setindex!-Tuple{Span, Any, Any}"><code>Base.setindex!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">(s::Span)[key] = val</code></pre><p>Set the attributes in span <code>s</code>. Only valid when the span is not ended yet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L119-L123">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Base.getindex(s::Span, key)</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.set_status!" href="#OpenTelemetryAPI.set_status!"><code>OpenTelemetryAPI.set_status!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_status!(s::Span, code::SpanStatusCode, description=nothing)</code></pre><p>Update the status of span <code>s</code> by following the original specification. <code>description</code> is only considered when the <code>code</code> is <code>SPAN_STATUS_ERROR</code>. Only valid when the span is not ended yet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L151-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.end!" href="#OpenTelemetryAPI.end!"><code>OpenTelemetryAPI.end!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">end!(s::Span, t=UInt(time()*10^9))</code></pre><p>Set the end time of the span and trigger span processors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L172-L176">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.is_recording" href="#OpenTelemetryAPI.is_recording"><code>OpenTelemetryAPI.is_recording</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_recording(s::Span)</code></pre><p>Returns <code>true</code> if this span <code>s</code> is recording information like <a href="#OpenTelemetryAPI.Event"><code>Event</code></a> operations, attribute modification using <a href="#Base.setindex!-Tuple{Span, Any, Any}"><code>setindex!</code></a>, etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/tracer_provider.jl#L112-L116">source</a></section></article><p>Some other exported symbols:</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TraceIdType</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpanIdType</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>INVALID_TRACE_ID</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>INVALID_SPAN_ID</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>current_span</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TraceFlag</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.TraceState" href="#OpenTelemetryAPI.TraceState"><code>OpenTelemetryAPI.TraceState</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TraceState(entries::Pair{String,String}...)</code></pre><p><code>TraceState</code> carries vendor-specific trace identification data, represented as a list of key-value pairs. <code>TraceState</code> allows multiple tracing systems to participate in the same trace. It is fully described in the <a href="https://www.w3.org/TR/trace-context/#tracestate-header">W3C Trace Context specification</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/basic.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.SpanContext" href="#OpenTelemetryAPI.SpanContext"><code>OpenTelemetryAPI.SpanContext</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SpanContext(;span_id, trace_id, is_remote, trace_flag=TraceFlag(), trace_state=TraceState())</code></pre><p>A <code>SpanContext</code> represents the portion of a <code>Span</code> which must be serialized and propagated along side of a distributed context. <code>SpanContext</code>s are immutable.</p><p>The OpenTelemetry <code>SpanContext</code> representation conforms to the <a href="https://www.w3.org/TR/trace-context/">W3C TraceContext specification</a>. It contains two identifiers - a <code>TraceId</code> and a <code>SpanId</code> - along with a set of common <code>TraceFlags</code> and system-specific <code>TraceState</code> values.</p><p><code>TraceId</code> A valid trace identifier is a 16-byte array with at least one non-zero byte.</p><p><code>SpanId</code> A valid span identifier is an 8-byte array with at least one non-zero byte.</p><p><code>TraceFlags</code> contain details about the trace. Unlike TraceState values, TraceFlags are present in all traces. The current version of the specification only supports a single flag called <a href="https://www.w3.org/TR/trace-context/#sampled-flag">sampled</a>.</p><p><code>TraceState</code> carries vendor-specific trace identification data, represented as a list of key-value pairs. TraceState allows multiple tracing systems to participate in the same trace. It is fully described in the <a href="https://www.w3.org/TR/trace-context/#tracestate-header">W3C Trace Context specification</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/basic.jl#L98-L123">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>INVALID_SPAN_CONTEXT</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.span_context" href="#OpenTelemetryAPI.span_context"><code>OpenTelemetryAPI.span_context</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">span_context([s::Span])</code></pre><p>Get the <code>SpanContext</code> from a span <code>s</code>. If <code>s</code> is not specified, <a href="#OpenTelemetryAPI.current_span"><code>current_span()</code></a> will be used. <code>nothing</code> is returned if no span context found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/basic.jl#L135-L139">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_KIND_UNSPECIFIED</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_KIND_INTERNAL</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_KIND_SERVER</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_KIND_CLIENT</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_KIND_PRODUCER</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_KIND_CONSUMER</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.LimitInfo" href="#OpenTelemetryAPI.LimitInfo"><code>OpenTelemetryAPI.LimitInfo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LimitInfo(;kw...)</code></pre><p>Used in <a href="@ref"><code>TracerProvider</code></a> to configure generated <a href="#OpenTelemetryAPI.Tracer"><code>Tracer</code></a>.</p><p><strong>Keyword arguments:</strong></p><ul><li><code>span_attribute_count_limit::Int</code> = 128</li><li><code>span_attribute_value_length_limit::Union{Nothing,Int}</code> = nothing</li><li><code>span_event_count_limit::Int</code> = 128</li><li><code>span_link_count_limit::Int</code> = 128</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/basic.jl#L154-L165">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.Link" href="#OpenTelemetryAPI.Link"><code>OpenTelemetryAPI.Link</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Link(span_context, attributes)</code></pre><p>See more details at <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/overview.md#links-between-spans">links between spans</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/basic.jl#L173-L177">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetryAPI.Event" href="#OpenTelemetryAPI.Event"><code>OpenTelemetryAPI.Event</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Event(name, timestamp=time()*10^9, attributes=StaticAttrs())</code></pre><p><code>timestamp</code> is the <em>nanoseconds</em>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/api/src/trace/basic.jl#L183-L187">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_STATUS_UNSET</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_STATUS_OK</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SPAN_STATUS_ERROR</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpanStatu</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Metric"><a class="docs-heading-anchor" href="#Metric">Metric</a><a id="Metric-1"></a><a class="docs-heading-anchor-permalink" href="#Metric" title="Permalink"></a></h3><p>The relationship between <code>MeterProvider</code>, <code>Meter</code> and different instruments are depicted below:</p><pre><code class="nohighlight hljs"> ┌─────────────────────────────┐
 │AbstractInstrument           │
 │                             │
 │  name                       │
 │  unit                       │
 │  description                │
 │                             │
 │  meter                      │
 │   ┌───────────────────────┐ │
 │   │Meter                  │ │
 │   │                       │ │
 │   │  provider             │ │
 │   │   ┌────────────────┐  │ │
 │   │   │   Abstract     │  │ │
 │   │   │ MeterProvider  │  │ │
 │   │   └────────────────┘  │ │
 │   │  name                 │ │
 │   │  version              │ │
 │   │  schema_url           │ │
 │   │                       │ │
 │   │  instrumentation      │ │
 │   │   ┌────────────────┐  │ │
 │   │   │ name           │  │ │
 │   │   │ version        │  │ │
 │   │   └────────────────┘  │ │
 │   │  instruments          │ │
 │   │                       │ │
 │   │    * Counter          │ │
 │   │    * Histogram        │ │
 │   │    * UpDownCounter    │ │
 │   │    * ObservableCounter│ │
 │   │    * Observable       │ │
 │   │      UpDownCounter    │ │
 │   └───────────────────────┘ │
 │                             │
 └─────────────────────────────┘</code></pre><ul><li>An <code>Instrument</code> belongs to a <code>Meter</code>, each <code>Meter</code> may contain many different <code>Instrument</code>s. Similarly, a <code>Meter</code> belongs to a <code>MeterProvider</code> and a <code>MeterProvider</code> may contain many different <code>Meter</code>s.</li></ul><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>global_meter_provider</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Meter</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Measurement</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Counter</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ObservableCounter</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Histogram</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ObservableGauge</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>UpDownCounter</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ObservableUpDownCounter</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="SDK"><a class="docs-heading-anchor" href="#SDK">SDK</a><a id="SDK-1"></a><a class="docs-heading-anchor-permalink" href="#SDK" title="Permalink"></a></h2><p>Two common exporters are provided to for debugging:</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>InMemoryExporter</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ConsoleExporter</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Trace-2"><a class="docs-heading-anchor" href="#Trace-2">Trace</a><a class="docs-heading-anchor-permalink" href="#Trace-2" title="Permalink"></a></h3><p>In SDK, a dedicated <a href="@ref"><code>TraceProvider</code></a> is provided.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TraceProvider</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetrySDK.CompositSpanProcessor" href="#OpenTelemetrySDK.CompositSpanProcessor"><code>OpenTelemetrySDK.CompositSpanProcessor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CompositSpanProcessor(processors...)</code></pre><p>A wrapper of different concrete span processors. Users can also <code>push!</code> new span processors into it after construction.</p><p>See also <a href="@ref"><code>SimpleSpanProcessor</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/sdk/src/trace/span_processor.jl#L13-L19">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ALWAYS_ON</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>ALWAYS_OFF</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetrySDK.DEFAULT_ON" href="#OpenTelemetrySDK.DEFAULT_ON"><code>OpenTelemetrySDK.DEFAULT_ON</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>Sampler that respects its parent span&#39;s sampling decision, but otherwise always samples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/sdk/src/trace/sampling.jl#L136-L138">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OpenTelemetrySDK.DEFAULT_OFF" href="#OpenTelemetrySDK.DEFAULT_OFF"><code>OpenTelemetrySDK.DEFAULT_OFF</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>Sampler that respects its parent span&#39;s sampling decision, but otherwise never samples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oolong-dev/OpenTelemetry.jl/blob/8d32cee2550c137310d5b10298abbac6e3c81cfa/src/sdk/src/trace/sampling.jl#L131-L133">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TraceIdRatioBased</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Metric-2"><a class="docs-heading-anchor" href="#Metric-2">Metric</a><a class="docs-heading-anchor-permalink" href="#Metric-2" title="Permalink"></a></h3><p>The current implementation of metrics in SDK is mainly inspired by the <a href="https://github.com/open-telemetry/opentelemetry-dotnet">dotnet sdk</a>.</p><pre><code class="nohighlight hljs">┌──────────────────────────────────────────┐
│MeterProvider                             │
│                                          │
│  meters                                  │
│  views                                   │
│                                          │
│  instrument_associated_metric_names      │
│    instrument =&gt;  Set{metric_name}       │
│                                          │
│  metrics                                 │
│    name =&gt; metric                        │
│    ┌───────────────────────────────────┐ │
│    │Metric                             │ │
│    │                                   │ │
│    │  name                             │ │
│    │  description                      │ │
│    │  criteria                         │ │
│    │  aggregation                      │ │
│    │    ┌──────────────────────────┐   │ │
│    │    │AggregationStore          │   │ │
│    │    │                          │   │ │
│    │    │  attributes =&gt; data_point│   │ │
│    │    │   ┌─────────────────┐    │   │ │
│    │    │   │AbstractDataPoint│    │   │ │
│    │    │   │                 │    │   │ │
│    │    │   │  value          │    │   │ │
│    │    │   │  start_time     │    │   │ │
│    │    │   │  end_time       │    │   │ │
│    │    │   │  exemplars      │    │   │ │
│    │    │   │ ┌────────────┐  │    │   │ │
│    │    │   │ │Exemplar    │  │    │   │ │
│    │    │   │ │            │  │    │   │ │
│    │    │   │ │ value      │  │    │   │ │
│    │    │   │ │ trace_id   │  │    │   │ │
│    │    │   │ │ span_id    │  │    │   │ │
│    │    │   │ └────────────┘  │    │   │ │
│    │    │   │                 │    │   │ │
│    │    │   └─────────────────┘    │   │ │
│    │    │                          │   │ │
│    │    └──────────────────────────┘   │ │
│    │                                   │ │
│    └───────────────────────────────────┘ │
│                                          │
└──────────────────────────────────────────┘</code></pre><p>A <a href="@ref"><code>View</code></a> specifies which instruments are grouped together through <a href="@ref"><code>Criteria</code></a>. For each view, a <a href="@ref"><code>Metric</code></a> is created to store the <a href="@ref"><code>Measurement</code></a>s. Each metric may have many different dimensions configured by <a href="@ref"><code>StaticAttrs</code></a> in a <a href="@ref"><code>Measurement</code></a>. For each dimension, we may also collect those [<code>Exemplar</code>]s in the mean while.</p><h4 id="Design-decisions"><a class="docs-heading-anchor" href="#Design-decisions">Design decisions</a><a id="Design-decisions-1"></a><a class="docs-heading-anchor-permalink" href="#Design-decisions" title="Permalink"></a></h4><ul><li>For each registered instrument, we have stored the associated metrics configured by views into the <code>instrument_associated_metric_names</code> field. So that for each pair of <code>instrument =&gt; measurement</code>, we can quickly determine which metrics to update.</li><li>The make sure that measurements with the same attribute key-values but with different order can be updated in the same dimension in the <a href="@ref"><code>AggregationStore</code></a>, a design from <a href="https://github.com/open-telemetry/opentelemetry-dotnet/issues/2374">opentelemetry-dotnet#2374</a> is borrowed here.</li></ul><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>MeterProvider</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>View</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Metric</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>AggregationStore</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 27 January 2022 09:15">Thursday 27 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
